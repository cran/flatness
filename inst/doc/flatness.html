<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Michaël Zamo" />

<meta name="date" content="2021-06-29" />

<title>Using the flatness package, illustrated with weather ensemble forecasts</title>

<script src="data:application/javascript;base64,Ly8gUGFuZG9jIDIuOSBhZGRzIGF0dHJpYnV0ZXMgb24gYm90aCBoZWFkZXIgYW5kIGRpdi4gV2UgcmVtb3ZlIHRoZSBmb3JtZXIgKHRvCi8vIGJlIGNvbXBhdGlibGUgd2l0aCB0aGUgYmVoYXZpb3Igb2YgUGFuZG9jIDwgMi44KS4KZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsIGZ1bmN0aW9uKGUpIHsKICB2YXIgaHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCJkaXYuc2VjdGlvbltjbGFzcyo9J2xldmVsJ10gPiA6Zmlyc3QtY2hpbGQiKTsKICB2YXIgaSwgaCwgYTsKICBmb3IgKGkgPSAwOyBpIDwgaHMubGVuZ3RoOyBpKyspIHsKICAgIGggPSBoc1tpXTsKICAgIGlmICghL15oWzEtNl0kL2kudGVzdChoLnRhZ05hbWUpKSBjb250aW51ZTsgIC8vIGl0IHNob3VsZCBiZSBhIGhlYWRlciBoMS1oNgogICAgYSA9IGguYXR0cmlidXRlczsKICAgIHdoaWxlIChhLmxlbmd0aCA+IDApIGgucmVtb3ZlQXR0cmlidXRlKGFbMF0ubmFtZSk7CiAgfQp9KTsK"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>


<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<link rel="stylesheet" href="data:text/css,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" type="text/css" />




</head>

<body>




<h1 class="title toc-ignore">Using the <code>flatness</code> package, illustrated with weather ensemble forecasts</h1>
<h4 class="author">Michaël Zamo</h4>
<h4 class="date">29 June 2021</h4>



<style>
body {
text-align: justify}
</style>
<p>In this vignette we first motivate the existence of the <code>flatness</code> package and its most important implementation, the Jolliffe-Primo flatness tests. Then we illustrate its functionalities with data sets from the weather forecasting field.</p>
<div id="motivation-of-the-flatness-package" class="section level1">
<h1>Motivation of the <code>flatness</code> package</h1>
<div id="limitations-of-the-chi2-test" class="section level2">
<h2>Limitations of the <span class="math inline">\(\chi^2\)</span> test</h2>
<p>The <code>flatness</code> package is dedicated to the task of assessing and testing whether an histogram of counts in ordered and consecutive categories is flat, i.e. all the categories have the same count up to sampling noise.</p>
<p>The flatness of a histogram is traditionally tested with a <span class="math inline">\(\chi^2\)</span> statistical test, the null hypothesis being that the counts are evenly distributed between the categories up to sampling noise. Although this test is powerful it is not sensitive to some specific deviations from flatness. Let us illustrate this with a synthetic example, following Elmore (2005).</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">20</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>K <span class="ot">&lt;-</span> <span class="dv">21</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>ranks <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>K, <span class="at">size =</span> K <span class="sc">*</span> N, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>shst <span class="ot">&lt;-</span> hst <span class="ot">&lt;-</span> <span class="fu">hist</span>(ranks, <span class="at">breaks =</span> <span class="dv">0</span><span class="sc">:</span>K <span class="sc">+</span> <span class="fl">0.5</span>)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> N, <span class="at">lty =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>shst<span class="sc">$</span>counts <span class="ot">&lt;-</span> <span class="fu">sort</span>(shst<span class="sc">$</span>counts)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(shst, <span class="at">col =</span><span class="st">&quot;lightgrey&quot;</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> N, <span class="at">lty =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Random counts&#39; chisquare statistics =&quot;</span>, <span class="fu">chisq.test</span>(hst<span class="sc">$</span>counts)<span class="sc">$</span>statistic, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Random counts&#39; chisquare statistics = 26.7</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Sorted counts&#39; chisquare statistics =&quot;</span>, <span class="fu">chisq.test</span>(shst<span class="sc">$</span>counts)<span class="sc">$</span>statistic, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Sorted counts&#39; chisquare statistics = 26.7</span></span></code></pre></div>
<p>We first randomly draw <span class="math inline">\(420\)</span> integers from a uniform distribution between 1 and <span class="math inline">\(K=21\)</span> then calculate the corresponding histogram <code>hst</code>. This one seems rather flat (i.e. counts are close to the expected theoretical value <span class="math inline">\(N = 20\)</span>, drawn as the horizontal dashed line) judging from the first plot. Then we tweak the histogram by reordering the counts in ascending order to produce a blatantly unflat histogram <code>shst</code>. Despite the blatant sloping shape of the sorted histogram, as confirmed by the second plot, its <span class="math inline">\(\chi^2\)</span> test statistics is the same as the one for the first (truly) random histogram. Jolliffe and Primo (2008) proposed to decompose the <span class="math inline">\(\chi^2\)</span> test statistic in such a way that one can test the existence of such specific deviations to flatness in histograms.</p>
</div>
<div id="the-jolliffe-primo-flatness-test" class="section level2">
<h2>The Jolliffe-Primo flatness test</h2>
<p>The principle of the Jolliffe-Primo test is the following (see Supplementary Material to Zamo et al., 2021). Let’s suppose a histogram with <em>K</em> possible ordered categories, each with count <span class="math inline">\(n_i\)</span> (with <span class="math inline">\(i=1,\ldots,K\)</span>), and <span class="math inline">\(e\)</span> the theoretical count in each category of a perfectly flat histogram (i.e. <span class="math inline">\(e = \frac{\sum_{i=1}^Kn_i}{K}\)</span>). Then the normalized deviation to flatness (i.e. Pearson residuals) of the histogram can be rewritten as a vector <span class="math display">\[\delta=\left(\frac{n_1 -e}{\sqrt{e}}, \ldots, \frac{n_K - e}{\sqrt{e}}\right).\]</span> The squared norm of this vector is just the <span class="math inline">\(\chi^2\)</span> test statistics, which explains why it does not change if we permutate the counts (i.e. the components of vector <span class="math inline">\(\delta\)</span>). This vector can then be projected on a set of up to <span class="math inline">\(K - 1\)</span> vectors <span class="math inline">\(u_j\)</span> (with <span class="math inline">\(j =1, \ldots, k \le K -1\)</span>). It can be shown that, if these vectors are deviates (i.e. the sum of each vector’s components is zero) and the set is orthonormal, then the squared modules of the projections <span class="math inline">\(\delta \cdot u_j\)</span> each approximately and independently follows a <span class="math inline">\(\chi^2\)</span> distribution with 1 degree of liberty, under the null hypothesis of a flat rank histogram. By choosing appropriate deviate vectors <span class="math inline">\(u_j\)</span> we can test whether the shape corresponding to each deviate vector is present in a given histogram.</p>
<p>Let’s now describe the <code>ensembles</code> and <code>ppensembles</code> data sets (shipped with the <code>flatness</code> package) that will be used to illustrate how to use the <code>flatness</code> package and the Jolliffe-Primo flatness test.</p>
</div>
</div>
<div id="the-ensembles-and-ppensembles-datasets" class="section level1">
<h1>The <code>ensembles</code> and <code>ppensembles</code> datasets</h1>
<div id="ensembles-and-rank-histograms" class="section level2">
<h2>Ensembles and rank histograms</h2>
<p>In Meteorology an ensemble forecast is a set of forecasts of the future state of the atmosphere. Each simulated evolution starts from a slightly different initial condition and use different evolution algorithm in order to represent the uncertainty of the future outcome. Each evolution is called a <em>member</em>. When forecasting a parameter if the ensemble forecast is a sample from the right multivariate probabilistic distribution of the outcome then the outcome and the members should be indistinguishable, so that any scalar outcome has the same probability to fall between any two consecutive forecast values. If one computes the rank of the observation when pooled with members and compute the count in each rank over several forecasts, then one should get a flat histogram up to sampling noise. This kind of histogram is called a <em>rank histogram</em> and its flatness can be assessed with scores and statistical tests.</p>
</div>
<div id="contents-of-the-ensembles-datasets" class="section level2">
<h2>Contents of the <code>ensembles</code> datasets</h2>
<p>Several meteorological institutions over the world issue their own ensemble forecasts, some of which are made freely available in the <a href="https://www.ecmwf.int/en/forecasts/dataset/thorpex-interactive-grand-global-ensemble">TIGGE</a> ensemble. The <code>ensembles</code> dataset contains several ensemble forecasts for the 2-m temperature in Blagnac, France and the associated measured temperature.</p>
<p>First load the package and the <code>ensembles</code> dataset used for illustrative purpose.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(flatness)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>ensembles <span class="ot">&lt;-</span> ensembles</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="fu">is</span>(ensembles)</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;list&quot;   &quot;vector&quot;</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(ensembles)</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;CWAO&quot; &quot;DEMS&quot; &quot;ECMF&quot; &quot;EGRR&quot; &quot;RKSL&quot;</span></span></code></pre></div>
<p>We can see that the <code>ensembles</code> dataset is a named list with five entries. Each entry contains the ensemble forecast of one weather forecasting organization.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(data.table)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>ensembles<span class="sc">$</span>CWAO</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;        date_run latitude longitude        1        2        3        4        5</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   1: 2019-03-01     43.5       1.5 280.3152 279.5232 276.6893 273.6942 276.5990</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   2: 2019-03-02     43.5       1.5 274.8378 274.4615 272.9161 274.2175 273.5043</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   3: 2019-03-03     43.5       1.5 280.1985 277.3259 278.9862 279.2702 279.2407</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   4: 2019-03-04     43.5       1.5 275.4946 277.2073 275.6813 277.1495 277.5157</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   5: 2019-03-05     43.5       1.5 278.4286 277.3543 277.7069 279.6607 280.0637</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  ---                                                                           </span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 727: 2021-03-27     43.5       1.5 271.2999 275.8482 272.9926 275.8783 273.1891</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 728: 2021-03-28     43.5       1.5 276.4429 276.1473 277.9194 275.5068 277.0300</span></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 729: 2021-03-29     43.5       1.5 279.0955 278.9508 280.1055 279.4067 279.1118</span></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 730: 2021-03-30     43.5       1.5 278.0254 279.8665 280.5095 279.3302 279.6777</span></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 731: 2021-03-31     43.5       1.5 280.3761 279.1144 279.3001 280.5096 280.3647</span></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             6        7        8        9       10       11       12       13</span></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   1: 279.3050 276.1084 279.8428 278.3054 281.2444 280.4360 277.3517 277.5993</span></span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   2: 274.4678 274.5705 274.7559 271.8764 273.9752 274.1097 273.8252 274.4106</span></span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   3: 278.0438 279.4622 283.5233 279.3260 282.0111 280.5855 283.0036 278.2077</span></span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   4: 277.1346 272.6506 276.4795 275.6070 277.4290 277.7994 274.1130 275.0794</span></span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   5: 277.6463 279.2020 279.4067 277.3104 278.9702 277.8915 278.2042 275.6957</span></span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  ---                                                                        </span></span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 727: 275.3884 273.5678 272.3508 273.5719 273.1230 274.1035 275.2148 273.4731</span></span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 728: 278.3895 276.4772 277.2625 276.9016 276.2067 277.9131 276.5159 278.6302</span></span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 729: 278.4906 279.4412 278.8210 278.7421 278.8204 280.5871 279.1756 278.3197</span></span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 730: 280.0230 279.3890 280.0062 278.7466 280.5102 279.4570 279.5275 279.0752</span></span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 731: 280.0109 280.9742 280.3582 279.1833 280.6151 279.7941 281.9291 279.8622</span></span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;            14       15       16       17       18       19       20      T</span></span>
<span id="cb5-28"><a href="#cb5-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   1: 280.1643 274.8325 279.2591 279.1006 279.0816 282.2659 278.7608 280.95</span></span>
<span id="cb5-29"><a href="#cb5-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   2: 274.8890 274.8842 272.5728 275.1929 273.7774 274.2302 274.6507 276.15</span></span>
<span id="cb5-30"><a href="#cb5-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   3: 281.3155 279.8067 278.5925 279.2088 278.9522 284.1115 281.8102 284.55</span></span>
<span id="cb5-31"><a href="#cb5-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   4: 278.2044 277.3690 277.7078 275.6547 277.7249 276.3633 277.5169 279.95</span></span>
<span id="cb5-32"><a href="#cb5-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   5: 276.7913 277.5009 279.4303 278.3975 279.3692 278.8182 279.2550 284.65</span></span>
<span id="cb5-33"><a href="#cb5-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  ---                                                                      </span></span>
<span id="cb5-34"><a href="#cb5-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 727: 273.8149 273.0809 272.4609 273.9666 271.8731 272.7964 273.0863 276.45</span></span>
<span id="cb5-35"><a href="#cb5-35" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 728: 278.3615 278.3091 277.5695 277.5956 277.7396 276.8420 278.2090 282.35</span></span>
<span id="cb5-36"><a href="#cb5-36" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 729: 279.0861 279.4996 280.1250 278.9508 279.7057 278.2358 279.3305 283.05</span></span>
<span id="cb5-37"><a href="#cb5-37" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 730: 278.8851 280.7101 280.1661 279.9876 279.1747 279.9753 280.6875 283.15</span></span>
<span id="cb5-38"><a href="#cb5-38" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 731: 279.3304 279.2093 279.5693 278.7148 279.0761 279.7060 279.3638 283.65</span></span>
<span id="cb5-39"><a href="#cb5-39" aria-hidden="true" tabindex="-1"></a><span class="fu">range</span>(ensembles<span class="sc">$</span>CWAO<span class="sc">$</span>date_run)</span>
<span id="cb5-40"><a href="#cb5-40" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;2019-03-01&quot; &quot;2021-03-31&quot;</span></span>
<span id="cb5-41"><a href="#cb5-41" aria-hidden="true" tabindex="-1"></a><span class="fu">sapply</span>(ensembles, <span class="cf">function</span>(x) <span class="fu">NCOL</span>(x) <span class="sc">-</span> <span class="dv">4</span>)</span>
<span id="cb5-42"><a href="#cb5-42" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; CWAO DEMS ECMF EGRR RKSL </span></span>
<span id="cb5-43"><a href="#cb5-43" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   20   11   50   17   24</span></span></code></pre></div>
<p>Each ensemble forecast is stored as a <code>data.table</code> and contains several entries</p>
<dl>
<dt>date_run</dt>
<dd>the date of the initial condition from which the ensemble starts. The run time is 00TC and the lead time 30h, so that each forecast is valid for the following day at 6UTC. Each ensemble covers two years with one forecast per day, from March 2019 to March 2021 (731 dates, October 2019 being missing).
</dd>
<dt>latitude, longitude</dt>
<dd>latitude and longitude of the nearest grid-point to the weather station (in °)
</dd>
<dt>1 … M</dt>
<dd>the forecast temperature for each member (in Kelvins). Note the number <em>M</em> of members varies from one ensemble to the other (from 11 for the DEMS ensemble up to 50 for the ECMF ensemble). Actually each ensemble has one more member, called the <em>control member</em>, not included in this data set
</dd>
<dt>T</dt>
<dd>the 2-m height temperaure (in Kelvins) measured at the Toulouse-Blagnac weather station in France.
</dd>
</dl>
</div>
<div id="contents-of-the-ppensembles-datasets" class="section level2">
<h2>Contents of the <code>ppensembles</code> datasets</h2>
<p>As we will see below ensembles have flaws that make their forecast probabilities unactionable for decision making. But since these forecast error are not completely random one can use machine learning methods to extract information from past forecast/observation archive and correct those errors. For ensemble forecast a much-used method is non homogeneous regression (NHR) introduced by Gneiting et al. (2005). In a nutshell NHR posits that the forecast parameter obeys some chosen probability distribution whose parameters depend on the ensemble statistics. The relationship between the probability distribution’s parameters and the ensemble statistics is fitted with likelihood maximization for instance.</p>
<p>The <code>ensembles</code> dataset has been post-processed with NHR by supposing the forecast temperature follows a Gaussian distribution whose mean and standard deviation linearly depends on the ensemble mean and standard deviation respectively. The regression coefficients have been adjusted by minimizing the CRPS over a 60-day sliding window. The <code>ppensembles</code> dataset has the same structure as the <code>ensembles</code> dataset with the “members” being a 30-sample from the forecast distribution.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>ppensembles <span class="ot">&lt;-</span> ppensembles</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">names</span>(ppensembles))</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;CWAO&quot; &quot;DEMS&quot; &quot;ECMF&quot; &quot;EGRR&quot; &quot;RKSL&quot;</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">str</span>(ppensembles<span class="sc">$</span>ECMF))</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Classes &#39;data.table&#39; and &#39;data.frame&#39;:   731 obs. of  34 variables:</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ date_run : Date, format: &quot;2019-03-01&quot; &quot;2019-03-02&quot; ...</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ latitude : num  43.5 43.5 43.5 43.5 43.5 43.5 43.5 43.5 43.5 43.5 ...</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ longitude: num  1.5 1.5 1.5 1.5 1.5 1.5 1.5 1.5 1.5 1.5 ...</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 1        : num  278 275 279 278 281 ...</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 2        : num  278 275 280 278 281 ...</span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 3        : num  280 276 280 278 281 ...</span></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 4        : num  280 276 280 278 281 ...</span></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 5        : num  280 276 281 278 282 ...</span></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 6        : num  280 276 281 278 282 ...</span></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 7        : num  280 276 281 279 282 ...</span></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 8        : num  280 276 281 279 282 ...</span></span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 9        : num  280 276 281 279 282 ...</span></span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 10       : num  280 276 281 279 282 ...</span></span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 11       : num  280 276 281 279 282 ...</span></span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 12       : num  281 276 282 279 282 ...</span></span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 13       : num  281 276 282 279 282 ...</span></span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 14       : num  281 277 282 279 282 ...</span></span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 15       : num  281 277 282 279 282 ...</span></span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 16       : num  281 277 282 279 282 ...</span></span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 17       : num  281 277 282 279 282 ...</span></span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 18       : num  281 277 282 279 283 ...</span></span>
<span id="cb6-27"><a href="#cb6-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 19       : num  281 277 282 279 283 ...</span></span>
<span id="cb6-28"><a href="#cb6-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 20       : num  281 277 282 279 283 ...</span></span>
<span id="cb6-29"><a href="#cb6-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 21       : num  282 277 282 280 283 ...</span></span>
<span id="cb6-30"><a href="#cb6-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 22       : num  282 277 282 280 283 ...</span></span>
<span id="cb6-31"><a href="#cb6-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 23       : num  282 277 282 280 283 ...</span></span>
<span id="cb6-32"><a href="#cb6-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 24       : num  282 277 283 280 283 ...</span></span>
<span id="cb6-33"><a href="#cb6-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 25       : num  282 277 283 280 283 ...</span></span>
<span id="cb6-34"><a href="#cb6-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 26       : num  282 278 283 280 283 ...</span></span>
<span id="cb6-35"><a href="#cb6-35" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 27       : num  282 278 283 280 283 ...</span></span>
<span id="cb6-36"><a href="#cb6-36" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 28       : num  282 278 283 280 283 ...</span></span>
<span id="cb6-37"><a href="#cb6-37" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 29       : num  283 278 283 280 283 ...</span></span>
<span id="cb6-38"><a href="#cb6-38" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ 30       : num  283 278 283 280 283 ...</span></span>
<span id="cb6-39"><a href="#cb6-39" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ T        : num  281 276 285 280 285 ...</span></span>
<span id="cb6-40"><a href="#cb6-40" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  - attr(*, &quot;.internal.selfref&quot;)=&lt;externalptr&gt; </span></span>
<span id="cb6-41"><a href="#cb6-41" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; NULL</span></span>
<span id="cb6-42"><a href="#cb6-42" aria-hidden="true" tabindex="-1"></a><span class="fu">sapply</span>(ppensembles, <span class="cf">function</span>(x) <span class="fu">NCOL</span>(x) <span class="sc">-</span> <span class="dv">4</span>)</span>
<span id="cb6-43"><a href="#cb6-43" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; CWAO DEMS ECMF EGRR RKSL </span></span>
<span id="cb6-44"><a href="#cb6-44" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   30   30   30   30   30</span></span></code></pre></div>
</div>
</div>
<div id="building-and-representing-a-rank-histogram" class="section level1">
<h1>Building and representing a rank histogram</h1>
<p>The workhorse to build rank histograms is the S3 generic function <code>rkhist</code>. Let’s start with one rank histogram. We can build it by sending a forecast matrix and an observation vector into <code>rkhist</code>.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>iobs <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">names</span>(ensembles<span class="sc">$</span>CWAO) <span class="sc">==</span> <span class="st">&quot;T&quot;</span>)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>ifcst <span class="ot">&lt;-</span> <span class="dv">4</span><span class="sc">:</span>(iobs <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>M <span class="ot">&lt;-</span> <span class="fu">length</span>(ifcst)</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>K <span class="ot">&lt;-</span> M <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;Number of members:&quot;</span>, M))</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Number of members: 20&quot;</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>fcst <span class="ot">&lt;-</span> <span class="fu">data.matrix</span>(ensembles<span class="sc">$</span>CWAO[, ifcst, <span class="at">with =</span> <span class="cn">FALSE</span>])</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>obs <span class="ot">&lt;-</span> <span class="fu">unlist</span>(ensembles<span class="sc">$</span>CWAO[, iobs, <span class="at">with =</span> <span class="cn">FALSE</span>])</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>rkh <span class="ot">&lt;-</span> <span class="fu">rkhist</span>(<span class="at">fcst =</span> fcst, <span class="at">obs =</span> obs)</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(rkh)</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;rkhist&quot; &quot;matrix&quot;</span></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(rkh)</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  &#39;rkhist&#39; int [1, 1:21] 1 1 0 0 1 1 2 0 3 2 ...</span></span></code></pre></div>
<p>The <code>rkhist</code> functions return an S3 object with class <code>c(&quot;rkhist&quot;, &quot;matrix&quot;)</code>. Since the ensemble from CWAO has 20 members, the rank histogram comprises <span class="math inline">\(K = 21\)</span> possible ranks for the observation. The returned object contains a matrix with one row by rank histogram (here only 1) and <span class="math inline">\(K\)</span> columns.</p>
<p>We can <code>plot</code> and <code>print</code> an <code>rkhist</code> object since both the corresponding methods have been implemented for this class. By setting the argument <code>what</code> to <code>counts</code>, <code>percents</code> or <code>proportions</code>, we can choose to represent the count, the frequency (in %) or proportion of observations in each rank respectively.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rkh)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rkh, <span class="at">what =</span> <span class="st">&quot;percents&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(rkh) <span class="ot">&lt;-</span> <span class="st">&quot;CWAO&quot;</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(rkh)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; rank</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   1   2   3   4   5   6   7   8   9  10  11  12  13  14  15  16  17  18  19  20 </span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   1   1   0   0   1   1   2   0   3   2   3   5   6   8   5  15  13  13  14  65 </span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  21 </span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 573</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(rkh, <span class="at">what =</span> <span class="st">&quot;percents&quot;</span>, <span class="at">digits =</span> 1L)</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; rank</span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    1    2    3    4    5    6    7    8    9   10   11   12   13   14   15   16 </span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  0.1  0.1  0.0  0.0  0.1  0.1  0.3  0.0  0.4  0.3  0.4  0.7  0.8  1.1  0.7  2.1 </span></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   17   18   19   20   21 </span></span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  1.8  1.8  1.9  8.9 78.4</span></span></code></pre></div>
<p>The plots show the expected count (or percentage) for a perfectly balanced rank histogram as a dashed horizontal line. It can be seen that the rank histogram is far from flat. From the printed tables we can see that the rank 21 contains 573 of the 731 observations, which means that the observation is higher than the highest forecast value 78% of the time, much higher than the expected value <span class="math inline">\(4.8\%\)</span>. This kind of imbalance is quite common for ensemble forecasts for near-surface parameters.</p>
</div>
<div id="applying-the-jolliffe-primo-flatness-test" class="section level1">
<h1>Applying the Jolliffe-Primo flatness test</h1>
<div id="defining-deviate-vectors" class="section level2">
<h2>Defining deviate vectors</h2>
<p>As stated earlier the Jolliffe-Primo flatness test requires a set of deviate vectors. Some deviate vectors can be obtained with functions named <code>deviate_XXX</code> where <code>XXX</code> is the required deviate shape.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>linear <span class="ot">&lt;-</span> <span class="fu">deviate_linear</span>(<span class="at">k =</span> K)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(linear)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>U <span class="ot">&lt;-</span> <span class="fu">deviate_U</span>(<span class="at">k =</span> K)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(U)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAY1BMVEUAAAAAADoAAGYAOjoAOpAAZrY6AAA6ADo6AGY6OgA6Ojo6ZrY6kNtmAABmADpmtrZmtttmtv+QOgCQtpCQ2/+pqam2ZgC225C2///bkDrbtmbb////tmb/25D//7b//9v///+ekDENAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAIZElEQVR4nO2d7XqjNhSEJ9ls2m7jbZumdOnaju//Kms+7cSGc2QJZsB6f6yTZw9H44kkQEgCh8woYAtQB2wB6oAtQB2wBagDtgB1wBagDtgC1AFbgDpgC1AHbAHqgC1AHbAFqAO2AHXAFqAO2ALUAVuAOmALUAdsAeqALUAdsAWoA7YAdcAWoA7YAtQBW4A6YAtQB2wB6oAtQB2wBagDtgB1wBagDtgC1AFbgDpgCxjj/RVPP4+f+w2+sjSAVbCHbJBBNsggG2SQDTLIBhlkgwyyQRZFNmicAo8/jh+752zQdUpUVei9AF5YEsAq2MUWLQ9vLAlgFeyjaA36naYAtJJ9/Pfb0Z4vf/IEgFf0MgBbgDpgC1AHbAHqgC1AHbAFqAO2AHXAFqAO2ALUAVuAOmALUAdsAeqALUAdsAWoA7YAdcAWoA7YAtQBW4A6YAtQB2wB6oAtQB2wBagDtgB1wBagDtgC1AFbgDpgC1AHbAHq4IZjds9/pZahCwJi9xv01DO/7gGEBG+biV65Bg2y31STKkcMwmKYxqDDoXh4GzUoMB0NJA/sKPGSDRpl9/zF0cSC087E5E3sUM9/Hzbon4Yb0s5DsEB34ETlz81cBpUD10HZoIEsPdmgxOXPTTbIYGKDjiewmsE7sTs3qOwW3WyHVt/ct0Hvr70tZb3QLUH5czOpQftNf4G4zaf5K+QaZFF29xi5DxqgG1McqD/ZoPTlz002yCAbZJANMsgGGWSDDPJ4kIFMDVIbvL/5L+gOdKbrylerSTcLcwdOrGNqskEG2SCDbJBBNsggG2SQDTLIBhlkgwziDdp/b/ZRG3peMbGOqUln0NC8jYl1TE2sQcXpfjxqx8LVGnSqQSQdU0PupC/Hg1ZokDlzY1IdU5PAoCLF6oIVG7TfpNhP9kIHe2Qxuu33gWdTN2L0fNbBrknRgvrA99cUWzav2KDDdnh6+Ix6UpPOoH4xWNqz2HoMcuBYUHffBh37Kat6rdggVxMze/IVG9RijHZYPfn6DToUUWf7OzAo8YDZ+gxKPGC2OoP2G1cTM9eLrc8gc4bvaJbBe8L1GCSiJzXZoKkFnQXunmG9RMe/Xuzz59zjQsna/CmwWX9Rjl0JBqwXY9ekZEL6wG4pz9A6nkPYap/1GdSNKI5cKIasF1ufQbkGDSTqf3L1Qe71Yis0yHMW868XW6NBUrpkhLgDZ9YlI6QLbMYKd8+RTw9Xa1CzOdnpk64rltQGFZ0vkU+g12qQ4wpnZl2xJDbIcY3sTPf5HnHo988HpP7dLcD8RvW/Zw3rpiFXLI8wg86eZRRxTcwb96nGDzeF0M/EQrvAfmvEyG1IveUuzqDu7qqMfC23t9zlGdQOFsbOEfKWu0CD0uBNlw2y4rJBRlw2yIjLBhlx2SAjLhtkxGWDjLiOZAYF3mN541gG9fHJDJpKaGjixOmyQVb8nRgUPszSHXgnBt2cLhtkxWeDjPiVGVQee5l6xHFwlmtQutUZVD68tfOEs0HXaJ6evb8+/Uxn0OdL6qmvoIOFhiTunp4VTz9TGXQ6cKaaEyw0pID++WvxNRt0lc6W/WZwxWFIug8HrsKgfg7e4NLDsHTnB67DoOnSZYOsA1dmUO6kpy734sDQ66Ebr3+Chd5awFTppq45wUJjC2qzxP5BT5mWbZC9HCoo3bUEizbIsRwqJN3VBEs2yLOYJSDd9QRWZ52oLbuPDynIsxwqIN0oU9WcPn/ywMM8NahPtESDPMuhQtKNcdHUUp0mu/zJA2vs5VBB6Rykrjl93uSBznSLYUKDzrqim3AX6Q1MHRd7UDbIIBtkkA0yyAZNjLtIb2DquPiD4nAX6Q1MHRd/UBzuIr2BqePiD4rDXaQ3MHVc/EH3BNgC1AFbgDpgC1AHbAHqgC1AHbAFqAO2AHXAFqAO2ALUAVuAOmALUAdsAepg3uKaB2v2Bhi7X+tH21tr38Imzshaz0l5ceW7BGHhsex+cenbb+pn/9vjt9mOfaM2bjzr++sxRVn5Z+a7AoKio/Htb7VtZiA1g98jr2lo44yszY4/5eMPM981EBQdTelRt8VL/ZX7b2bEubIea46V7yoICY6n+AbXezgbg+qWM1o9mv/0ZC0efzjyXYKQ4GiabRoL26H6WzTdxWinUcd5slbzURz5LkFIcCIcf8MggxxZt10fvQiDHPukhTUxM2szn2kBTazBca53ddKHjwYNZ20nny6gk24kepuY47R8ZuRw1tMaJf3TfK3O20k7Luzas9ho1tMWxwu4UKzfuu3YqbGtDqV1a9DGjWYtmyllVSIz3yUIC78/wBagDtgC1AFbgDpgC1AHbAHqgC1AHbAFqAO2AHXAFqAO2ALUAVuAOmALUAdsAeqALUAdsAWoA7YAdcAWoA7YAtQBW4A6YAtQB2wB6oAtQB2wBagDtgB1wBagDtgC1AFbwAXdRnLX5iJEvib3FjB3gSbNW6cP22uzEbJBh96g9uMj2aDDyZn6ha/tvJb95o9N9UNtUOybPMPAjGX5OK9B1cyo5k0D1WT5h7fKoNIzvygdmLMwF61BlQ/772/NBLu65hx/OH5e7ZsmBLOW5qE7i/Ub7tVNq25nR4O+zdq+DpoGfa1qS1uN8Pjv87lBD3/7lsMkA7OW5qFpYvXM5nr66u6DQS+Rb+sOBnMW5qLtg4pqRmo93x4fDYp8XXcomLMwF61B1QKMpvIc69K5QdWylBnlYMayfHTXQdXlTj1tt6hO72cGNW8XmgvMWNYiAVuAOmALUAdsAeqALUAdsAWoA7YAdcAWoA7YAtQBW4A6YAtQB2wB6oAtQB2wBagDtgB1wBagDtgC1AFbgDpgC1AHbAHqgC1AHbAFqAO2AHXAFqDO/+edm7YXTpfmAAAAAElFTkSuQmCC" /><!-- --></p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>V <span class="ot">&lt;-</span> <span class="fu">deviate_V</span>(<span class="at">k =</span> K)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(V)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>ends <span class="ot">&lt;-</span> <span class="fu">deviate_ends</span>(<span class="at">k =</span> K)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(ends)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>wave <span class="ot">&lt;-</span> <span class="fu">deviate_wave</span>(<span class="at">k =</span> K)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(wave)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">is</span>(wave))</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;rkhist&quot;</span></span></code></pre></div>
<p>Each <code>deviate_XXX</code> function requires an argument <code>k</code> that is the number of components of the deviate vector, and returns an <code>rkhist</code> object. Deviate vectors are not rank histogram but this class is used so that one can <code>plot</code> and <code>print</code> deviate vectors. The <code>deviate_XXX</code> functions return only one deviate vectors but function <code>get_deviates</code> allows to get a set of several deviate vectors.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>deviates <span class="ot">&lt;-</span> <span class="fu">get_deviates</span>(<span class="at">k =</span> K, <span class="at">shapes =</span> <span class="fu">c</span>(<span class="st">&quot;linear&quot;</span>, <span class="st">&quot;U&quot;</span>, <span class="st">&quot;V&quot;</span>, <span class="st">&quot;ends&quot;</span>, <span class="st">&quot;wave&quot;</span>))</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">str</span>(deviates))</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  &#39;rkhist&#39; num [1:5, 1:21] -0.36 0.423 0.342 0.673 -0.373 ...</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  - attr(*, &quot;dimnames&quot;)=List of 2</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   ..$ : chr [1:5] &quot;linear&quot; &quot;U&quot; &quot;V&quot; &quot;ends&quot; ...</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   ..$ : NULL</span></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; NULL</span></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(deviates)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --></p>
<p>Function <code>get_deviates</code> requires the number of possible categories (<code>k</code>) and the required shapes (<code>shapes</code>), and returns an <code>rkhist</code> object with one deviate by row for each requires shape. Internally this function calls a function named <code>deviate_XXX</code> for each required shape in <code>shapes</code>. This allows the user to easily implements its own deviate by following this naming convention to code its own function returning an <code>rkhist</code> object.</p>
</div>
<div id="checking-and-imposing-the-requirements-for-the-jolliffe-primo-flatness-test" class="section level2">
<h2>Checking and imposing the requirements for the Jolliffe-Primo flatness test</h2>
<p>As stated above the Jolliffe-Primo flatness test requires a set of deviate vectors such that the set is orthonormal. This can be checked with function <code>is_JP_ready</code>.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>check <span class="ot">&lt;-</span> <span class="fu">is_JP_ready</span>(<span class="at">x =</span> deviates, <span class="at">tol =</span> <span class="fl">0.001</span>)</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Vector set is not OK (tolerance is: 0.001)</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Cross product should be unit diagonal:</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;               linear             U             V          ends          wave</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; linear  1.000000e+00 -2.775558e-17  1.387779e-17  0.000000e+00  0.000000e+00</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; U      -2.775558e-17  1.000000e+00  9.671773e-01  6.286946e-01 -2.775558e-16</span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; V       1.387779e-17  9.671773e-01  1.000000e+00  5.085586e-01 -2.220446e-16</span></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ends    0.000000e+00  6.286946e-01  5.085586e-01  1.000000e+00 -1.665335e-16</span></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; wave    0.000000e+00 -2.775558e-16 -2.220446e-16 -1.665335e-16  1.000000e+00</span></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Row sums should be null:</span></span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;        linear             U             V          ends          wave </span></span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  0.000000e+00  2.602085e-16 -4.163336e-17  2.081668e-16 -2.719559e-15</span></span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">str</span>(check))</span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; List of 5</span></span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ isOK     : logi FALSE</span></span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ tol      : num 0.001</span></span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ crossprod: num [1:5, 1:5] 1.00 -2.78e-17 1.39e-17 0.00 0.00 ...</span></span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   ..- attr(*, &quot;dimnames&quot;)=List of 2</span></span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .. ..$ : chr [1:5] &quot;linear&quot; &quot;U&quot; &quot;V&quot; &quot;ends&quot; ...</span></span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .. ..$ : chr [1:5] &quot;linear&quot; &quot;U&quot; &quot;V&quot; &quot;ends&quot; ...</span></span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ sums     : Named num [1:5] 0.00 2.60e-16 -4.16e-17 2.08e-16 -2.72e-15</span></span>
<span id="cb18-22"><a href="#cb18-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   ..- attr(*, &quot;names&quot;)= chr [1:5] &quot;linear&quot; &quot;U&quot; &quot;V&quot; &quot;ends&quot; ...</span></span>
<span id="cb18-23"><a href="#cb18-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ x        : &#39;rkhist&#39; num [1:5, 1:21] -0.36 0.423 0.342 0.673 -0.373 ...</span></span>
<span id="cb18-24"><a href="#cb18-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   ..- attr(*, &quot;dimnames&quot;)=List of 2</span></span>
<span id="cb18-25"><a href="#cb18-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .. ..$ : chr [1:5] &quot;linear&quot; &quot;U&quot; &quot;V&quot; &quot;ends&quot; ...</span></span>
<span id="cb18-26"><a href="#cb18-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .. ..$ : NULL</span></span>
<span id="cb18-27"><a href="#cb18-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; NULL</span></span></code></pre></div>
<p>This function requires as argument a matrix <code>x</code> containing the checked vectors (one vector in each row). It checks whether the sum of components of each vector is 0 and the set of vectors is orthonormal. The optional argument <code>tol</code> gives a tolerance on the conditions. <code>is_JP_ready</code> returns a named list with the following entries</p>
<dl>
<dt>isOK</dt>
<dd>a logical. Are both requirements true?
</dd>
<dt>tol</dt>
<dd>a numeric. The tolerance used to check the requirements.
</dd>
<dt>crossprod</dt>
<dd>a matrix. This is the cross product between the row-vectors of the input matrix
</dd>
<dt>sums</dt>
<dd>a named numeric vector containing the sum of components of each row-vector in the input matrix
</dd>
<dt>x</dt>
<dd>the input vectors
</dd>
</dl>
<p>Here we can see that the set of vectors <code>deviates</code> do not meet the requirements for the Jolliffe-Primo test due to the deviates <code>U</code>, <code>V</code> and <code>ends</code> being not orthogonal. One can use the function <code>make_JP_ready</code> to enforce the requirements on a set of vectors.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>deviates_ok <span class="ot">&lt;-</span> <span class="fu">make_JP_ready</span>(<span class="at">x =</span> deviates)</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Vector set is not OK (tolerance is: 1e-04)</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Cross product should be unit diagonal:</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;               linear             U             V          ends          wave</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; linear  1.000000e+00 -2.775558e-17  1.387779e-17  0.000000e+00  0.000000e+00</span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; U      -2.775558e-17  1.000000e+00  9.671773e-01  6.286946e-01 -2.775558e-16</span></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; V       1.387779e-17  9.671773e-01  1.000000e+00  5.085586e-01 -2.220446e-16</span></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ends    0.000000e+00  6.286946e-01  5.085586e-01  1.000000e+00 -1.665335e-16</span></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; wave    0.000000e+00 -2.775558e-16 -2.220446e-16 -1.665335e-16  1.000000e+00</span></span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Row sums should be null:</span></span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;        linear             U             V          ends          wave </span></span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  0.000000e+00  2.602085e-16 -4.163336e-17  2.081668e-16 -2.719559e-15</span></span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>check <span class="ot">&lt;-</span> <span class="fu">is_JP_ready</span>(<span class="at">x =</span> deviates_ok)</span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Vector set is OK (tolerance is: 1e-04)</span></span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(deviates_ok)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --></p>
<p>Function <code>make_JP_ready</code> returns a vector set that can be used in the Jolliffe-Primo flatness test, by using the Grahm-Schmidt method on the input set (if necessary) and normalizing the sum of each vector’s components to zero (if necessary). But as can be noted from the plots above the shapes in the returned set may differ a lot from the ones in the inputted vector set (compare the histogram for <code>V</code> and <code>ends</code> with the previous plot). It is thus strongly advised to check visually that the deviates returned by this function really match the shapes the user wants to test the presence of in the histograms.</p>
<p>In the following we use the default set of deviate vectors <code>c(&quot;linear&quot;, &quot;U&quot;, &quot;wave&quot;)</code>.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>deviates <span class="ot">&lt;-</span> <span class="fu">get_deviates</span>(<span class="at">k =</span> K)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">row.names</span>(deviates))</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;linear&quot; &quot;U&quot;      &quot;wave&quot;</span></span></code></pre></div>
</div>
<div id="applying-the-jolliffe-primo-flatness-test-1" class="section level2">
<h2>Applying the Jolliffe-Primo flatness test</h2>
<p>Function <code>JP_test</code> implements the Jolliffe-Primo flatness test. It is an S3 generic function that requires two arguments <code>rkhists</code> (the histograms to be tested) and <code>deviates</code> (the matrix of deviates, with one deviate in each row).</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>JP <span class="ot">&lt;-</span> <span class="fu">JP_test</span>(<span class="at">rkhists =</span> rkh, <span class="at">deviates =</span> deviates)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">str</span>(JP))</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; List of 3</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ deviates:List of 1</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   ..$ : &#39;rkhist&#39; num [1:3, 1:21] -0.36 0.423 -0.373 -0.324 0.296 ...</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .. ..- attr(*, &quot;dimnames&quot;)=List of 2</span></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .. .. ..$ : chr [1:3] &quot;linear&quot; &quot;U&quot; &quot;wave&quot;</span></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .. .. ..$ : NULL</span></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ rkhists :List of 1</span></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   ..$ : &#39;rkhist&#39; int [1, 1:21] 1 1 0 0 1 1 2 0 3 2 ...</span></span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .. ..- attr(*, &quot;dimnames&quot;)=List of 2</span></span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .. .. ..$ : chr &quot;CWAO&quot;</span></span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .. .. ..$ : NULL</span></span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ test    : num [1:3, 1, 1:4] 241 58055 0 258 66442 ...</span></span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   ..- attr(*, &quot;dimnames&quot;)=List of 3</span></span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .. ..$ result: chr [1:3] &quot;projections&quot; &quot;statistics&quot; &quot;pvalues&quot;</span></span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .. ..$ rkhist: chr &quot;CWAO&quot;</span></span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   .. ..$ test  : chr [1:4] &quot;linear&quot; &quot;U&quot; &quot;wave&quot; &quot;resid.&quot;</span></span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  - attr(*, &quot;class&quot;)= chr [1:2] &quot;JPtest&quot; &quot;list&quot;</span></span>
<span id="cb21-20"><a href="#cb21-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; NULL</span></span></code></pre></div>
<p>The returned object by the implemented method is a named list with the following entries:</p>
<dl>
<dt>deviates</dt>
<dd>the set of <span class="math inline">\(S\)</span> deviates used as argument of the function
</dd>
<dt>rkhists</dt>
<dd>the <span class="math inline">\(R\)</span> (rank) histograms used as argument of the function
</dd>
<dt>test</dt>
<dd>this is a 3xRx(S+1) array containing the information necessary for the test.
</dd>
</dl>
<p>The <code>test</code> entry has the following contents in each dimension:</p>
<dl>
<dt>projections</dt>
<dd>the projection of each rank histogram on each deviate
</dd>
<dt>statistics</dt>
<dd>the corresponding <span class="math inline">\(\chi^2\)</span> test statistics
</dd>
<dt>pvalues</dt>
<dd>the p-values computed from the test statistics
</dd>
</dl>
<p>Let’s note that the last dimension of the <code>test</code> entry has length the number of deviates <em>plus one</em>. Indeed if the square of the projections of the histogram vector on each deviate follows a <span class="math inline">\(\chi^2\)</span> distribution with one degree of liberty, the module of the projection of the histogram vector on the complement of the vector space spanned by the set of deviates follow a <span class="math inline">\(\chi^2\)</span> distribution with <span class="math inline">\(K -S -1\)</span> degrees of liberty. <code>Jp_test</code> computes the test statistics and p-value for this complement vector. This allows to test whether deviations other than the one tested may be present in the rank histogram. But, as for the <span class="math inline">\(\chi^2\)</span> test on the initial histogram, this test is not powerful in detecting specific shapes. The name of this dimension in the <code>test</code> entry is <em>resid.</em> (for <em>residuals</em>).</p>
<p>Finally let’s note that this function does not actually perform the Jolliffe-Primo test but return the required information (p-values) to perform it. This implementation choice has been made because the flatness test is usually a multi-hypothesis statistical testing (several deviations are tested for several histograms), which requires corrections, such as the Bonferroni correction or the Benjamini-Hochberg procedure. The Benjamini-Hochberg procedure is implemented in function <code>BH_procedure</code> of the <code>flatness</code> package. See Benjamini and Hochberg (1995) for more details.</p>
</div>
<div id="printing-and-plotting-results" class="section level2">
<h2>Printing and plotting results</h2>
<p>Function <code>JP_test</code> is an S3 generic function whose methods should return an object with S3 class <code>JPtest</code>. Corresponding methods for class <code>JPtest</code> of functions <code>print</code> and <code>lattice::levelplot</code> have been implemented.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(JP)</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Results of the Jolliffe-Primo test:</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; projections:</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   linear        U     wave   resid. </span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 240.9467 257.7638 215.0518       NA </span></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; statistics:</span></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    linear         U      wave    resid. </span></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  58055.32  66442.15  46247.26 162748.26 </span></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; pvalues:</span></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; linear      U   wave resid. </span></span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      0      0      0      0</span></span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(JP, <span class="at">what =</span> <span class="st">&quot;pvalues&quot;</span>)</span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Results of the Jolliffe-Primo test:</span></span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; pvalues:</span></span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; linear      U   wave resid. </span></span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      0      0      0      0</span></span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lattice)</span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a><span class="fu">levelplot</span>(JP)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">levelplot</span>(JP, <span class="at">what =</span> <span class="st">&quot;projections&quot;</span>, <span class="at">main =</span> <span class="st">&quot;projections&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>These two functions take a <code>JPtest</code> object as argument and a character vector as <code>what</code> argument that allows to choose what is printed or plotted. It can take values “projections”, “statistics” or “pvalues” to display the associated dimension of the <code>test</code> entries in the inputted <code>JPtest</code> object.</p>
</div>
<div id="working-with-several-ensembles" class="section level2">
<h2>Working with several ensembles</h2>
<p>If all the ensembles have the same number of members (such as in the <code>ppensembles</code> data set) one can process them in one go.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>ppensembles <span class="ot">&lt;-</span> ppensembles</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>fcsts <span class="ot">&lt;-</span> <span class="fu">lapply</span>(ppensembles, <span class="cf">function</span>(x) x[, <span class="dv">4</span><span class="sc">:</span><span class="dv">33</span>, <span class="at">with =</span><span class="cn">FALSE</span>])</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>obss <span class="ot">&lt;-</span> <span class="fu">lapply</span>(ppensembles, <span class="cf">function</span>(x) <span class="fu">t</span>(x[, <span class="dv">34</span>, <span class="at">with =</span><span class="cn">FALSE</span>]))</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>rkhists <span class="ot">&lt;-</span> <span class="fu">rkhist</span>(fcsts, obss)</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(rkhists)</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         rank</span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; forecast  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23</span></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     CWAO 23 20 19 19 24 25 29 19 22 17 19 27 30 29 28 21 18 19 19 21 20 35 22</span></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     DEMS 36 33 24 23 15 17 22 20 31 23 15 24 20 14 21 26 25 18 24 23 28 25 29</span></span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     ECMF 53 32 17 18 17 16 17 13 14  8 24 27 22 29 24 24 25 30 21 32 26 28 27</span></span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     EGRR 31 30 21 19 29 26 17 15 22 20 22 26 29 26 22 26 22 14 14 27 26 18 23</span></span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     RKSL 32 22 23 37 19 17 26 15 18 20 30 17 26 29 22 11 31 30 23 22 21 17 21</span></span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         rank</span></span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; forecast 24 25 26 27 28 29 30 31</span></span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     CWAO 16 20 11 13 25 29 29 63</span></span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     DEMS 21 24 28 32 25 24 17 24</span></span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     ECMF 21 30 19 18 23 20 23 33</span></span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     EGRR 27 21 23 27 18 30 24 36</span></span>
<span id="cb24-19"><a href="#cb24-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     RKSL 28 27 22 32 18 17 20 38</span></span>
<span id="cb24-20"><a href="#cb24-20" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rkhists, <span class="at">what =</span> <span class="st">&quot;percents&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAilBMVEUAAAAAADoAAGYAOjoAOmYAOpAAZrY6AAA6ADo6AGY6Ojo6OmY6OpA6ZrY6kNtmAABmADpmAGZmOgBmOjpmkLZmtrZmtttmtv+QOgCQOjqQtpCQttuQ2/+pqam2ZgC2kDq225C22/+2///bkDrbtmbbtpDb27bb2//b////tmb/25D//7b//9v////r4eP6AAAACXBIWXMAAA7DAAAOwwHHb6hkAAAIJUlEQVR4nO2da2ObNgBFcbLEa7ba3bql3tbQLWxdsM3//3vTA2zwEBcJhFRxz4fEShAiJ0ISepFVZJAs9AXEDgUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASIR1CRNTy8yfA/H8XH+/f/io/ng/7F5oe/bgL+iVVQoyHbfGoFss3nbsA/kQq6WsjuXtuhx27APzEJEioaSpE/nkVG+nubZTvpRN12x6343gn4v6w4BQkJ9f1zfHp+uwiq8pYgFfB/WTEJavhUnfad24c5SNIWJP74XetXrWJn1w34J2pBZV1mX508tsvvxwUyUFSCrmVQfYvdCvruj+qanVTAP3EKqgvpliDx5culhXQN+CdOQZdq/vz152u5XKiWTyfgn5gE9TcNs/eXWiyX5VMn4J9IBbUeNZ471fzdayfg/7JiFVRVXz+KVvT9L9JFq22YPXYC/i8rHkGRQkEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCDAPIKyb49lBfk6nT8oCEBBAAoCOAgq69Jr0tzaZAVdl9ecD1Nm16Yq6PRT20k35Cfd0LAMAlAQwE3QcTt1DU3agk4f5BKkSYbSFnT88W1SCW2Tbmhsa7G9bP0wBw0cmMsGoiyDBhtBzSIl40HpCpKK4CLiojmkNB2bsiD59w+vvzofLloKw42YrCDxqCGX0ZaDtbwuqRSl4SZLVdD5IEugd6+yGDIXQivOQapuP/+Gtpspmkf91ZVB1xw0jLwTJcYbMVVBqv6eY7+iZAVNTc56sCA0ngTVy7LN3Y6pChrZYSbrrlw2lk77lRXS47pcVTVfqqJqbdW8BHfaq4aibiKuraE4jpXnoBFcyqBWm3rC6ULCWgzATnsABQEoCGAv6GZvR9/phsYlB8ktoKZu3Zi0oGoGR6kL0oo4u8N0YJnpffjch8ZSFiR7C7UZ04PWnOmGxqUWY4/ipAODnM4fLoJycYMZhyvmTjc0LkPPqgA67Sc1FxMW1AybTiihbdINjb2gpounoCDDgXrY9Lh1KYTWMewjZwdNHT1MWtCi6YaGggAOguD0ulnTDY1LO2iODdATFmQcTfaTbmjcG4oLpRsal4biHDvoJyxIPKfOkIUSFtTMrmMt5nhgkNP5g4IALoLETfbwlrPDzHRguflcPLwNN4fWvJhF9gfJ+T9D/UGrXswiG4pS0ECP4oqXIlTXHJSbRw1XvJhFosugYqC5uO4cVDcVB3sU17uYZSzrXcyyeLqhWfhZbB2jGoox44bHrbEgT19QlZu7hS6ZzJzPViBoKAvVlde6c9Dg0PNpL+uvVQtCszty0VBapyDYxKkRD6zrFDSa4/aeggY5H8zPawkLGlGHz5luaJyHfYae5udMNzQu/UHajKkjY+Z0Q+Nwi33QHR2co2g4sMlBAz2Kc6YbGrceRfG1mDYHL2VBuh6bto1i2oIWTTc0FATg0DPA09DzfOmGxs/Q84zphsbL0POc6YbGy9DzwFnWMKqBh57nTDc0foaeZ0w3NGwHAdzKoAXTDQ1n2gNcCmkuZhk8kBPJJx4Y5HT+oCCApaB5SmibdEPjImiOip6C5ko3NBQEoCAABQEoCGAtaI6pHTbpBiTsm3qzm85FU/g2gm24+eGoxFo/te769CXo5aV7abfhvsuHdM5/e0b1U3P4NoIfQXjF4Yu6kMuXl9bVvdxeYyvcOqDvoyHuTQr/jzCQghdBI1Ycwj/S6aOHCD4EjVkvtmpB5hWHuPiIDh+CRuQgl3TcfuXhjNMj4BWHLukkJGj0dHyrdFIS5A4FuadDQSAdCgLpUBBIh4JAOhT0TUNBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIASwjSPdl92+4c36nRo9JmjYga3d1ZRyuag61iLSPo+L3hgk57/epxccHl2Is+H8SRhdRtFU2uE1QHW8WqlhFkmsNf6kF+Pdw2sHdaB715kfh7raKplaZy2367xKplBBX9l1NmO6Xu8idbnFLkAftoUpB1rCUE5U+Z4fWtWpC6A+2WiuR3r/bR5K4S1rEWEKR3hutdb64uVJcINuWCGtm1jVaqf5J1YotV873/NEdBZVNG20WTL5CNV1DvznBut5ieGeBwZ8qSK8JbTNNb1zsV0kV7u0ursl1EibGQ1tdkvsUsa95miolVtMs1RFnNq8sxF9J2bbfrSxitosntAJScGBuKVZ5l/cvx62xVWLT+Cz0BRx5vE+16DVax+LAKoSAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQHiE9Rs4tQ32WHiWz9ciFGQmptS9k13oKDqIqj+1oWCqqsZ9YKPetLKaf/rXn5QggrrvXmmEK0g9U1OvZKTd097Ob1+81kKmvjmD1uiFSQ9qPcuytlzKueID+J7b9nkkRgF6VrsstmVurXUfSYEPS16f1VxCnqUuaXORtndn9u2oM3vppUxnohUkJ4LreamHjuCdhNf42lNrILUe9v1RPysK2jgXeU+iFaQXOGhM4/IS21BciHLgpcTrSDV3FFTdnNZvbcEnfbjp4FPJz5BkUFBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQH+A2QGUrqEqEtpAAAAAElFTkSuQmCC" /><!-- --><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rkhists)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAkFBMVEUAAAAAADoAAGYAOjoAOmYAOpAAZrY6AAA6ADo6AGY6OgA6Ojo6ZmY6ZpA6kNtmAABmADpmOgBmkLZmkNtmtrZmtttmtv+QOgCQkDqQkGaQtpCQttuQ2/+pqam2ZgC2kDq2kGa225C229u22/+2///bkDrbtmbbtpDb27bb////tmb/25D/27b//7b//9v///9s+UVLAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAIcUlEQVR4nO2deWObNhyGcbrGXbPZXdfGOxy6I2wtns33/3bTARhjSS/ilK33+aNxYgnEU13AD5EUxEmydAFCh4IAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgKEIihLFKsf/278Jnj7rUj1D4H89Ch+nv54XyedmsAEieN+LgyCVnvx1+NWCzrtGkmnJjhBysWVoGQj0hzWWlD97cPr9AULR5A62q8/lQoaxy4EPak2psQ8yj+sPhfFf6IezVCFAhMkm5Fw0Rb0w1rUq9Pu4ZdSkPpWVKjN9AULTZD+cG5iz0rQ551wcVi//VI1sdXHv2YqWICCRGVpC3pORb3Kk03W7KS/+/3bDAW7EUG5+DpNnrWgovjnvVYUXyddC7rog1Z70d982q72eSlI1KKvv67rX6YkNEGi+ag+qCVItSrZyoSTunNO5xjnAxMkx+7rYV7UKT2JVoLEQLf6WXQ//67jEmSeKAoFSlCuJoui8jQninE1MfOphhIk/hFqhCYtqDrViGwmbT5ZrQTpvkkLKk5qFHvzMaZhPlgoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBBhZUHIzLCVo3M1Nx0SCquA3a+xb5IKy6uGI3PaURNyCTrtaS/bWHB8Yt6Djtn78KLc0srgFsQYhsuoJNvZBFtRTo0n1jO3gzS0I50GAmQX5T1CXZiJBqX4cQD+lPXxzCzKNIOXn3f5iwB+wuSWZaB4kxq5UPYLEYd6ErDflXIgTRSOy9mSsQXaO24dXVYVyWy8duaBCPRmZOB6FjF7QzJubDgoCUBCAggAUBKAgAAUBKAhAQQBeMAOwBgEoCEBBAAoCUBCAggAUBPAXdPygr6LaLsePvN+l6S8ocwmKN8IsPc+FHSvsRh1hVtUgB4wPAkQeYQb7l9hrUIqHr6gjzFRkAiLmCDNrRMs0+10af0Gn3YCldaO4YJZ3fgnDYW1NeceCqu7FMYrVSeyp7lhQF8rBK84a1InjVo5fcQrq0MQkqVoXPEZBJfBqhzhhdQm6lbGsfxNL0Wh/WL9xCHqR3LUgfMFMnLTFLMh5wQxv7u4FHbeD3lVxx4LgeWi3zWlB4ffUi93V0ILCr0YUpEpjr8l9BKl3LFofdOq4ubAE2cvR62xenmhlw16s6CNo+p5qVEHVBWfb1WaPInUVNHk9G1VQdUWx153V82WQ+xV02zXIfA54633QmIKME9RxBc0+ig0W1Kg2bUGNBj+eoDGYV9DZypUgVA4KGluQvutzWA98e/L4glyz4RkF6YvN5599mUCQ4yBnFJRWXjrdgXZsbiJB9lH8pTn/MpbDnLfT4dQJO8RtlOlQhNlEguyj+IsxgeOrMgHa72XCDpE/kg4RZucZdXJBO0FxWTeSZl5T+uogm98njfyVhfaMvl2Kqx10FXSuQcPigxqCmseftL9vHZ/p99b2Lo6/3klLUOv3l+TiD0mPIIKqD6ovtKb2JtYlwuyqaoM+1tHROlO199BK4CqH3/SiTFjf6nLc8+pUg5Cgxn/fTQmqepXMFeTaJcIMCmoX9FYElQMUuKWBI8zGFNToPDoKamcYU9A4jCvIWkFsgtBX7SJ0OaLhUgrLBTOHIFfdMHVSNyNIvuZcdUO2yUBHQVep2nlvVFC22pe3XinIhB7mTzvRRS8jyNGIgxBUTRTFXHIZQd0/LlmDpKHHHoKue+b5BV2ctowvqG5YYjrUQ5DryGYS1N7D2ILqqfRpR0H9cFVtV5nbCWIT5H2QFAQ+tjp0Chp8vBREQRREQRREQb29gAtm0Qs6b46CKIiCKIiCKIiCKIiCKIiCKIiCKGhmQV5hwBEK6hAGHLWg/kGckQiyhwEnt8cUgro+sOC5n35fTbDF4RlwGHCf/dyRoAELfEQiqD8U1H8/FAT2Q0FgPxQE9kNBYD8UdNNQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgwByC9JVs06oXh+/V3aPcZ3lCdXd3450tqxJ75ZpH0OGdpUDHrbq9losC510LfdqJlJnU7ZVNPm6rEnvlKuYRZFtsKNc3+fXtNvg2hhK9fo84Xq9sagUpudKf386KeQRl5uLkyUapqw/ZY5OiDvhnk4K8c80hKH1KLC/f1IJUC/RbhTh9ePXPJlfW8M41gyC9NmNqMqQKqnsEn35B3dn1zZar/yTvnc02zBv/03oKyqs+2i+bXHUkXEHGxdH6NTEdGdCjZcqeK8AmpjGO9b066az5ljOvvl1kCbGT1mWyNzHPkfe8PIZHtroMQQ7zqjj2Ttpv7nZesNgrm1weUskJcaKoXrVtXJ6xrFaZx+w/0wE4Mr1PtnMZvHLxZBVCQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAoQnqFrEyRTsMPA1uX0IUZCKTclN4Q4UVNSCyh+XUFBxNqNe+FoGrRy3n7bygxLkfpPn2AQrSP2QoVf6tXgyvH61l4Iyc6jRVAQrSHo4ftjr6DlVc8QH8dPYN01IiIL0KFYvdqWalmpnQtDTrO2rCFPQo6wtZTVKHv5cNwWtfrM9GTMRgQrSsdAqNvVwIWjjelv3FIQqqEhlNKoKxE8uBble1z0BwQqST3joyiPqUlOQfJBlxuIEK0hNd1TIbiqH94Yg/SrcuQhPUGBQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEGA/wElmJLhk/YvaAAAAABJRU5ErkJggg==" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAgVBMVEUAAAAAADoAAGYAOjoAOmYAOpAAZrY6AAA6ADo6AGY6Ojo6OmY6ZrY6kNtmAABmADpmOgBmOjpmkLZmtrZmtttmtv+QOgCQtpCQttuQ2/+pqam2ZgC2kDq225C22/+2///bkDrbtmbbtpDb27bb2//b////tmb/25D//7b//9v////QjEoLAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAIBklEQVR4nO2da2ObNhiFcbLFXVe765Z689gWuq7Y5v//wOnCRXIRB4GFZXSeD43VIBBPdDO8iKwig2T3LkDsUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQYB4BBVZw4/fZPrfT+Lj84f/xMfLQf9i8/M/V4nwxCqo0ZBtPhuJbHO0E+GJVFBnIXt6M1MvdiI8MQkSKhpKUT9eRUX6ss2ynXSimt1pK35aifDFilOQkFC3n9P712+toCo3BKlE+GLFJKjhc3XeW82HNUhiChInvzN+ZXQ7OzsRnqgFlXWf3Tl5MfvvlwUqUFSCuj6obmLXgn74o+qqk0qEJ05BdSdtCBL//NXOkLpEeOIU1A7zl6+/dP1yoWY+ViI8MQnqnxpmH9pRLJf9k5UIT6SCjK8ar9Yw//RmJcIXK1ZBVfX1k5hFP/8qXRhzw+zFSoQvVjyCIoWCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBgBsLyh6Gewm67e7CEUhQExjnjH1LXFDRxLaXriD3tAVdDq2WwhGknLag876Nuy0djSxtQaxBiKIJ3WYf5OC816OY8zGJ1AUtvbtwLCzIf4J6bwIJysXgddoOPJCduCDl593RGvBn7O6eBJoHibErVw+QcJjvQ9abei7EiWIvsvYUrEFuznv5PJuoQqWrl05cUPOYrftBtuQFLby7cFAQgIIAFASgIAAFASgIQEEACgLwghmANQhAQQAKAlAQgIIAFASgIIC/oPNHfRXVdTn+xse9N9MFFUOC0o0wy7u58MACqUlHmDU1aADGBwESjzCD/UvqNSjHw1fSEWYqMgGRcoSZM6IlzHHvjb+gy2HGwqhJXDArR68+fNo6t1yxoKZ7GRjF2k3cW61Y0BjqwSvNGjSK816OX2kKGtHEJPnmmKigGni1Q3xhfXBBM584zNFof9o+P7igPwXTBeELZuJLW8qCBi+Y+e8uQuYJOu9nvWlgxYLg91C/3UXMzCY28+C33V0QKAgwWZB8zmnumyfXLEh/0SrmvVHoES56TBTUXHB2XW32OPj4o9+FyaOYrjqT7qx2l0G0oPiqkVGkGGrQVRF8hAWSaxTpvn1QvyCPIvkV369g8wTdZhRbs6CblYOCQDkWENTfU13/b3/PPE2Qvutz2s58+e2QINT9GuOgsa1DRe8eB/4wcwXpi83dz6kMCUJTJDNvt23/6fTvMaCgvPEy6g70wO5WKmhE3Ea9HYowW6mgEZE/khERZt2MOrP+oz2dq47DSJv9SnsSru0bQdbvM3fa2rnPVLQR1NWgefFBV4LMtFXE6+1rQfb52L+/2p/aY2YzkNYZpgoy7mXk7iY2JsLsTk3s+rjflcPMMKGJdfcCB+55japBHoLMttD+kS1B123jjoKaXqUYCnIdE2HmI2ig+FcfHXmXFFQPUOCWBo4wM4rQ/dWXFXRdG28k6DYM9SNLCepVcWdB9mDhJcgalB5eUCHORXVDrsnAUEc7dJIrEVRsjvWt1/GCxp3kOgTpYf5yEF10TIL6mvZ3nfYigpqJophLxiRoIMPAxxCC2oli/jJdkDE7XJ2gtmGJ6dBkQV3pViionUpfDhQ0jZFlHjX5SVmQ70cKGne+5pUeCpqVl4IoiIIoiIIoaLwX9wUzCrJ3R0EUREEUREEUREEUREEUREEUREEUtLAgrzDgBAWNCANOWpBnEGd6gtxhwNnjEULQ2AcWPI8z7VcB9jg/Aw4DnnKcFQmascBHIoKmQ0HTj0NB4DgUBI5DQeA4FASOQ0EPDQUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgIsIUhfye5b9eL0k7p7VPosT6ju7u68sxXNxl65lhF0euco0Hmvbq+VosDl2EJfDmLLQur2yiYft1Ube+WqlhHkWmyo1Df59e02+DaGGr1+jzhfr2xqBSm50p/fwaplBBX9xSmznVLXnrLHLkUd8M8mBXnnWkJQ/j5zvHxTC1It0G8V4vzpzT+bXFnDO9cCgvTajHmfIVVQ3SP49Avqzq5vtlL9kbwPttgw3/tHmyiobPpov2xy1ZF4BfUujjatienIgAktU/ZcETYxTe9YP6mTLsy3nHn17SJLjJ20LpO7iXmOvN3yGB7Z2jJEOcyr4rg7ab+5W7dgsVc2uTykkhPjRFG9art3eca6WhUes/9CB+DI7X2ydWXwysUvqxAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQID5BzSJOfcEOM1+TO4UYBanYlLIv3IGCqlZQ/cOGgqrOjHrhax20ct7/tpcflKDhN3nemmgFqR8y9Eq/Fk+G12+OUlDRH2oUimgFSQ/nj0cdPadqjvggfvb2TQGJUZAexdrFrlTTUu1MCHq/aPuq4hT0ImtLXY2yp7+3pqDN764nYwIRqSAdC61iU0+WoN3Q27pDEKugKpfRqCoQP7MFDb2uOwDRCpJPeOjKI+qSKUg+yLJgcaIVpKY7KmQ3l8O7IUi/Cncp4hMUGRQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEOB/IxSuf4eW+/IAAAAASUVORK5CYII=" /><!-- --><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>deviates <span class="ot">&lt;-</span> <span class="fu">get_deviates</span>(<span class="at">k =</span> <span class="fu">NCOL</span>(rkhists))</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>ppJP <span class="ot">&lt;-</span> <span class="fu">JP_test</span>(rkhists, deviates)</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a><span class="fu">levelplot</span>(ppJP, <span class="at">main =</span> <span class="st">&quot;pvalues&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">levelplot</span>(ppJP, <span class="at">what =</span> <span class="st">&quot;projections&quot;</span>, <span class="at">main =</span> <span class="st">&quot;projections&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
<div id="flatness-indices" class="section level1">
<h1>Flatness indices</h1>
<p>Wilks (2019) compared several indices computed from rank histograms that have been proposed to assess whether a rank histogram is flat. These indices can be computed with the S3 generic function <code>flatness_indices</code> of the <code>flatness</code> package.</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>indices <span class="ot">&lt;-</span> <span class="fu">flatness_indices</span>(rkhists)</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(indices)</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;          chisq        RI   entropy</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; CWAO 104.47332 0.2463263 0.9828671</span></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; DEMS  36.02736 0.1672477 0.9927921</span></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ECMF  85.05062 0.2470323 0.9840062</span></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; EGRR  35.43365 0.1813689 0.9928062</span></span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; RKSL  54.17784 0.2271744 0.9893028</span></span></code></pre></div>
<p>Function <code>flatness_indices</code> takes as argument a matrix containing (rank) histograms in each row (by default, unless the argument <code>col_wise</code> is set to <code>TRUE</code>). It returns a matrix with three columns and as many rows as inputted histograms. The three columns correspond to the tree computed flatness indices the <span class="math inline">\(\chi^2\)</span> statistics, the reliability index and the entropy. Please refer to Wilks (2019) and references therein for further details on the last two indices.</p>
<div id="references" class="section level3">
<h3><strong>References</strong></h3>
<p>Benjamini, Y., &amp; Hochberg, Y. (1995). Controlling the false discovery rate: a practical and powerful approach to multiple testing. <em>Journal of the Royal statistical society: series B (Methodological)</em>, <strong>57</strong>(1), 289-300. <a href="https://doi.org/10.1111/j.2517-6161.1995.tb02031.x" class="uri">https://doi.org/10.1111/j.2517-6161.1995.tb02031.x</a></p>
<p>Elmore, K.L. (2005) Alternatives to the chi-square test for evaluating rank histograms from ensemble forecasts. <em>Weather and forecasting</em>, <strong>20</strong>, 789–795. <a href="https://doi.org/10.1175/WAF884.1" class="uri">https://doi.org/10.1175/WAF884.1</a></p>
<p>Gneiting, T., Raftery, A. E., Westveld III, A. H., &amp; Goldman, T. (2005). Calibrated probabilistic forecasting using ensemble model output statistics and minimum CRPS estimation. <em>Monthly Weather Review</em>, <strong>133</strong>(5), 1098-1118. <a href="https://doi.org/10.1175/MWR2904.1" class="uri">https://doi.org/10.1175/MWR2904.1</a></p>
<p>Jolliffe, I.T. and Primo,C. (2008) Evaluating rank histograms using decompositions of the chi-square test statistic. <em>Monthly Weather Review</em>, <strong>136</strong>, 2133–2139. <a href="https://doi.org/10.1175/2007MWR2219.1" class="uri">https://doi.org/10.1175/2007MWR2219.1</a></p>
<p>Wilks, D. S. (2019). Indices of rank histogram flatness and their sampling properties. <em>Monthly Weather Review</em>, <strong>147</strong>(2), 763-769. <a href="https://doi.org/10.1175/MWR-D-18-0369.1" class="uri">https://doi.org/10.1175/MWR-D-18-0369.1</a></p>
<p>Zamo, M, Bel, L, Mestre, O. (2021) Sequential aggregation of probabilistic forecasts — Application to wind speed ensemble forecasts. <em>J R Stat Soc Series C.</em>, <strong>70</strong>, 202– 225. <a href="https://doi.org/10.1111/rssc.12455" class="uri">https://doi.org/10.1111/rssc.12455</a></p>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
